# 新天-流程中心上线需要修改文件

## 后端

1. 配置文件 application-druid.yml

   数据库连接：url

   用户名密码：username password

2. 配置文件application.yml

   profile: 

3. 认证地址：

   ```yaml
   # 门户统一登录配置信息
   unifiedlogin:
     client_id: 239462240125175036
     client_secret: ry8MGpgVDB664QmC50WJZ4277BHCQNZ2
     joinsys_code: e7bd97e6b581e7a8
     #redirect_url: http://10.10.11.27/attend/login?loginType=phonenumber
     redirect_url: http://iw3.suntien.com:7926/BPC/
     manager_code: http://w3.suntien.com:956/XTSSO/api/oauth/getCode
     manager_token: http://w3.suntien.com:956/XTSSO/api/oauth/getAccessToken
     manager_user_info: http://w3.suntien.com:956/XTSSO/api/getUserInfo
     xt_cookie_name: xt_tyyh_token
   ```

​	redirect_url: 要与门户中配置的相同

​	client_id ：向门户配置人员索要

​	client_secret：向门户配置人员索要

​	joinsys_code：向门户配置人员索要

## 前端

1. permission.js 文件中

   ```js
    if(process.env.NODE_ENV == 'development'){
           //开发环境  去本身登录页
           next(`/login?redirect=${to.fullPath}`) // 否则全部重定向到登录页
           NProgress.done()
         }else{
           //门户地址
           window.location.href='http://zta.suntien.com:956/XTSSO/user/login'// 否则全部重定向到登录页
           //next(`/login?redirect=${to.fullPath}`) // 否则全部重定向到登录页
           NProgress.done()
         }
   ```

2. env.production

   ```
   # 智慧仓集成服务/生产环境     如果集成到统一门户，需要加上前缀，我这里是BPC
   VUE_APP_BASE_API = '/BPC/suntien/prod-api'
   
   ```

3. vue.config.js



## nginx配置

安装linux

默认安装目录

默认安装配置文件：/etc/nginx/nginx.conf

```properties
    server {
        listen       8087;
        #listen       [::]:80;
        server_name  localhost;
        location /BPC {
                #rewrite ^/BPC/(.*)/$ $1/111 break;
                alias     /root/dist/;
                try_files $uri $uri/ /index.html;
                index  index.html index.htm;
        }
        location /BPC/suntien/prod-api/ {
                proxy_set_header Host $http_host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header REMOTE-HOST $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_pass http://localhost:9090/;
        }

        error_page 404 /404.html;
        location = /404.html {
        }

        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
        }
    }
```

